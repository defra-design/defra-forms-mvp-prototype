{% extends "layouts/main.html" %}
{% from "components/service-header/macro.njk" import serviceHeader %}
{% set pageName = "Add radio question - Apply for a county parish holding number in England" %}
{% set headingPlaceholder = "Page heading" %}
{% set guidancePlaceholder = "" %}
{% block header %}
{{ serviceHeader({
organisationName: "Defra",
productName: "Forms Designer",
serviceName: "",
containerClasses: containerClasses,
accountName: "Chris Smith",
homepageLink: "/",
signOutLink: "/onboarding/sign-out-confirmation",
navigationItems: [
{ href: "/library.html", text: "Forms library", id: "nav-library" },
{ href: "/cph-overview/draft/complete-clean.html", text: "Overview", id: "nav-overview" },
{ href: "/redesigntest/listing", text: "Editor", id: "nav-editor" } ],
activeLinkId: "nav-editor"
}) }}

<div class="x-govuk-masthead x-govuk-masthead--large">
	<div class="govuk-width-container">
		{{ govukBackLink({ classes: "govuk-back-link--inverse govuk-!-margin-bottom-0", text: "Back to add
		and edit pages", href: "/redesigntest/listing.html" }) }}

		<hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible"
			style="border-bottom: 1px solid white; margin-bottom: 0" />

		<div class="govuk-grid-row">
			<div class="govuk-grid-column-full-from-desktop">
				<h1 class="x-govuk-masthead__title">
					{# <span class="govuk-caption-l" style="color: white">Apply for a county parish holding
						certificate</span> #}
					Food order form (user research)
				</h1>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
	<div class="govuk-grid-column-full">
		<div class="govuk-grid-row">
			<!-- Left Column for Form Controls -->
			<div class="govuk-grid-column-one-half-from-desktop" id="container" style="flex: 1 1 75%; overflow-y: auto">
				<div class="govuk-summary-card govuk-!-margin-top-0" style="border-left: 10px solid #008938">
					<div class="govuk-summary-card__content govuk-!-padding-top-0" style="background-color: #f3f2f1">

						<dl class="govuk-summary-list">
							<div class="govuk-summary-list__row">
								<dd class="govuk-summary-list__value">
									<!-- Dynamic Summary List -->

									<!-- Question Settings Container -->
									<div class="govuk-grid-row" id="page-settings-container-1">
										<div id="question-1">
											<div class="govuk-summary-card__content" style="margin-bottom: 0">
												<!-- Sub Navigation for Question -->
												<nav class="moj-sub-navigation govuk-!-padding-top-0 govuk-!-margin-bottom-2"
													aria-label="Sub navigation">
													<ul class="moj-sub-navigation__list" id="nav-list2">
														<!-- Question Link -->
														{# <li class="moj-sub-navigation__item">
															<a class="moj-sub-navigation__link" href="#question-1">Page
																settings</a>
														</li> #}

														{# <li class="moj-sub-navigation__item">
															<a class="moj-sub-navigation__link"
																href="#question-1-information-type">Question 10</a>
														</li> #}
														<li class="moj-sub-navigation__item">
															<a class="moj-sub-navigation__link" aria-current="page"
																href="#overview-noquestions">Add radio option</a>
														</li>

													</ul>
												</nav>

												<div class="govuk-summary-card__title-wrapper govuk-!-padding-top-0">
												</div>

												<span class="govuk-caption-l">Page #: question #</span>
												<h2 class="govuk-heading-l">Add radio option</h2>

												<form method="post" id="radio-options-form"
													action="/configure-radio-nf">
													{% from "govuk/components/input/macro.njk" import govukInput %}
													{% from "govuk/components/textarea/macro.njk" import govukTextarea
													%}
													{% from "govuk/components/fieldset/macro.njk" import govukFieldset
													%}
													{% from "govuk/components/button/macro.njk" import govukButton %}
													{% from "govuk/components/summary-list/macro.njk" import
													govukSummaryList %}

													<!-- List config -->
													<div class="govuk-form-group">

														<div id="options-container">
															<div class="radio-option-config">
																<!-- Option Value (Label) -->
																<div class="govuk-form-group">
																	<label class="govuk-label govuk-label--m"
																		for="option-label">Option text
																	</label>
																	<div class="govuk-hint">Enter an option for your
																		list</div>
																	<input class="govuk-input" id="option-label"
																		name="label" type="text" value="">
																</div>

																<!-- Hint Text -->
																<div class="govuk-form-group">
																	<label class="govuk-label govuk-label--m"
																		for="option-hint">Hint text (optional)</label>
																	<div class="govuk-hint">Provide additional
																		information about this option</div>
																	<input class="govuk-input" id="option-hint"
																		name="hint" type="text" value="">
																</div>

																<!-- Additional Value -->
																<div class="govuk-form-group">
																	<label class="govuk-label govuk-label--m"
																		for="option-value">Option value</label>
																	<div class="govuk-hint">You can keep this the same
																		as the option text unless you call it something
																		different in your backend system
																	</div>
																	<input class="govuk-input" id="option-value"
																		name="value" type="text" value="">
																</div>
															</div>
														</div>
													</div>

													<!-- Error Message Input -->
													{# <div class="govuk-form-group" style="margin-top: 20px">
														{{ govukInput({
														label: {
														text: "Short description",
														classes: "govuk-label--m",
														isPageHeading: false
														},
														hint: {
														text: "Enter a short description for this question like 'licence
														period'. Short descriptions are used in error messages and on
														the check your answers page."
														},
														id: "error-message-input",
														name: "errorMessageInput"
														}) }}
													</div> #}

													{# <!-- Add guidance above this question -->
													<details class="govuk-details" data-module="govuk-details">
														<summary class="govuk-details__summary">
															<span class="govuk-details__summary-text">
																Add guidance above this question (optional)
															</span>
														</summary>
														<div class="govuk-details__text">
															<!-- Default Content for Question 1 -->
															<div id="question-1-content" class="question-content"
																style="margin-top: 10px;">
																<!-- Page Heading Input -->
																{{ govukInput({
																label: {
																text: "Page heading",
																classes: "govuk-label govuk-label--m
																govuk-!-margin-top-0"
																},
																hint: {
																text: "Page headings should be a statement and not a
																question. For example, ‘Passport information’",
																id: "page-heading-input-hint"
																},
																id: "page-heading-input-radios",
																name: "pageHeadingInputRadios",
																type: "text",
																attributes: {
																'aria-describedby': "page-heading-input-hint"
																}
																}) }}

																<!-- Guidance Text Textarea -->
																{{ govukTextarea({
																label: {
																text: "Guidance text (optional)",
																classes: "govuk-label govuk-label--m"
																},
																hint: {
																text: "Use Markdown to format the content or add
																hyperlinks",
																id: "guidance-textarea-hint"
																},
																id: "guidance-textarea-radios",
																name: "guidanceTextareaRadios",
																rows: 5,
																attributes: {
																'aria-describedby': "guidance-textarea-hint"
																}
																}) }}
															</div>
														</div>
													</details> #}
													<div class="govuk-button-group">

														{{ govukButton({
														text: 'Save option',
														type: 'submit'
														}) }}

														<a class="govuk-link"
															href="javascript:window.history.back()">Cancel</a>

														<!--<a class="govuk-button" href="edit.html">Save option</a>-->
													</div>
											</div>
											</form>
										</div>
									</div>
							</div>
							</dd>
					</div>
					</dl>
				</div>
			</div>


			<!-- Right Column for Preview -->

			<!-- Right Column for Preview -->
			{# <div class="govuk-grid-column-one-half-from-desktop" id="second-container"
				style="outline: solid 1px #008938; height: 100vh;overflow-y: auto; position: sticky; top: 0; padding: 20px; box-shadow: 5px 10px #008938;">
				#}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/textarea/overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/numbers/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/date/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/address/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/phone/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/fileupload/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/email/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/previews-more-than-1-question/yesno/for-overview.html" %} #}
				{# {% include "/redesigntest/templates/more-than-1-question/previews/checkboxes.html" %} #}

				{# <div id="border-left-container-radios" name="borderLeftContainerRadios">
					{% include "/redesigntest/templates/previews-more-than-1-question/radios/edit-v2.html" %}

				</div>
			</div>
		</div> #}

		<!-- Right Column for Preview -->
		<div class="govuk-grid-column-one-half-from-desktop" id="second-container"
			style="outline: solid 1px #008938; height: 100%; position: sticky; top: 0; padding: 20px; box-shadow: 5px 10px #008938;">
			<!-- Before content -->
			<div id="before-content" style=" background-color:  #cce2d8;">
				<p class="govuk-body-s" style="margin-bottom: 0; color: #005a30; padding: 2px 8px 3px;
	  text-align: center;"> Previews
				</p>
			</div>

			<div style="margin-top: 60px;">
				{% from "govuk/components/tabs/macro.njk" import govukTabs %}

				<div class="govuk-tabs" data-module="govuk-tabs">
					<h2 class="govuk-tabs__title">
						Contents
					</h2>
					<ul class="govuk-tabs__list">
						<li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
							<a class="govuk-tabs__tab" href="#tab-one">Radio option preview</a>
						</li>

					</ul>

					<div class="govuk-tabs__panel" id="tab-one">
						<!-- Page Preview Content -->


						<p class="govuk-body-s" style="margin-bottom: 30px; border-bottom: #008938 1px;">
							<a href="#" class="govuk-link govuk-link--no-visited-state" rel="noreferrer noopener"
								target="_blank">
								Preview this page in a new tab
							</a>
						</p>

						{% include "/redesigntest/templates/previews-more-than-1-question/radios/edit-v2.html" %}

						<a href="#edit-page" class="govuk-skip-link" style="margin-bottom: 30px!important;"
							data-module="govuk-skip-link">
							Skip to edit page
						</a>
					</div>


				</div>
			</div>

		</div>

		<style>
			.fauxlabel {
				border: 0;
				text-transform: capitalize;
			}

			.govuk-radios__item label {
				text-transform: capitalize;
			}

			.fauxlabel:focus,
			.fauxlabel:active {
				background-color: transparent !important;
			}

			.gem-c-reorderable-list .gem-c-reorderable-list__item:hover,
			.gem-c-reorderable-list__item:hover .fauxlabel {
				background-color: #fff;
				cursor: initial;
			}

			.gem-c-reorderable-list__item:hover .fauxlabel:focus {
				cursor: initial;
			}
		</style>

		<!-- to populate the form with multiple animals append ?animals=dog,cat,lion,tiger,bear to the url -->

		<!-- Updated JavaScript -->
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				// DOM Elements for dynamic preview and placeholders
				const domElements = {
					multiQuestionLabelInputRadios: document.getElementById('multi-question-label-input-radios'),
					multiQuestionOutputRadios: document.getElementById('multi-question-output-radios'),
					hintTextInput: document.getElementById('multi-question-hint-text-input-radios'),
					multiQuestionHintTextOutputRadios: document.getElementById('multi-question-hint-text-output-radios'),
					makeOptionalCheckbox: document.getElementById('makeOptional'),
					pageHeadingInputRadios: document.getElementById('page-heading-input-radios'),
					dynamicHeading: document.getElementById('dynamic-heading'),
					guidanceTextareaRadios: document.getElementById('guidance-textarea-radios'),
					guidanceParagraph: document.getElementById('guidance-paragraph'),
					errorMessageInput: document.getElementById('error-message-input'),
					errorDynamicText: document.getElementById('error-dynamic-text'),
					optionsContainer: document.getElementById('options-container'),
					addOptionButton: document.getElementById('add-option-button'),
					editOptionsButton: document.getElementById('edit-options-button'),
					radioList: document.getElementById('radio-list'), // The preview area
					optionLabelInput: document.getElementById('option-label'), // Option label input
					optionHintInput: document.getElementById('option-hint'), // Hint text input
					optionValueInput: document.getElementById('option-value') // Additional value input
				};

				// Ensure required DOM elements exist
				if (!domElements.radioList || !domElements.optionLabelInput || !domElements.optionHintInput || !domElements.optionValueInput) {
					console.error("One or more required elements not found");
					return; // Exit early if the required elements are not found
				}

				// Initial preview update
				updatePreview();

				// Add event listeners for placeholder and preview functionality
				domElements.optionLabelInput.addEventListener('input', () => {
					updatePreview();
					applyHighlight('label');
				});
				domElements.optionHintInput.addEventListener('input', () => {
					updateHintPreview();
					applyHighlight('hint');
				});
				domElements.optionValueInput.addEventListener('input', updatePreview);

				// Focus/blur handlers for placeholder text and highlights
				domElements.optionLabelInput.addEventListener('focus', () => {
					applyHighlight('label');
				});
				domElements.optionLabelInput.addEventListener('blur', () => {
					removeHighlight('label');
				});

				domElements.optionHintInput.addEventListener('focus', () => {
					applyHighlight('hint');
					showHintPlaceholderInPreview("Hint text");
				});
				domElements.optionHintInput.addEventListener('blur', () => {
					removeHighlight('hint');
					removeHintPlaceholderFromPreview();
				});

				// Function to update the preview dynamically
				function updatePreview() {
					const optionLabelValue = domElements.optionLabelInput.value.trim();
					const optionValue = domElements.optionValueInput.value.trim();

					// Clear the current preview
					domElements.radioList.innerHTML = '';

					const newOptionHTML = `
				<div class="govuk-radios__item">
					<input
						class="govuk-radios__input"
						id="preview-option-1"
						name="listPreview"
						type="radio"
						value="${optionValue || 'default-value'}"
					>
					<label class="govuk-label govuk-radios__label" for="preview-option-1">
						${optionLabelValue || 'Option text'}
					</label>
					<div id="preview-option-1-hint" class="govuk-hint govuk-radios__hint"></div>
				</div>
			`;
					domElements.radioList.insertAdjacentHTML('beforeend', newOptionHTML);

					// Update the hint preview
					updateHintPreview();
				}

				// Function to update the hint preview
				function updateHintPreview() {
					const optionHintValue = domElements.optionHintInput.value.trim();
					const hintElement = domElements.radioList.querySelector('.govuk-radios__hint');

					if (hintElement) {
						hintElement.textContent = optionHintValue || '';
					}
				}

				// Function to show hint placeholder in the preview
				function showHintPlaceholderInPreview(placeholderText) {
					const hintElement = domElements.radioList.querySelector('.govuk-radios__hint');
					if (hintElement && domElements.optionHintInput.value.trim() === '') {
						hintElement.textContent = placeholderText;
					}
				}

				// Function to remove hint placeholder from the preview
				function removeHintPlaceholderFromPreview() {
					const hintElement = domElements.radioList.querySelector('.govuk-radios__hint');
					if (hintElement && domElements.optionHintInput.value.trim() === '') {
						hintElement.textContent = '';
					}
				}

				// Functions to apply/remove highlights
				function applyHighlight(type) {
					const targetElement = type === 'label'
						? domElements.radioList.querySelector('.govuk-radios__label')
						: domElements.radioList.querySelector('.govuk-radios__hint');

					if (targetElement) {
						targetElement.classList.add('highlight');
					}
				}

				function removeHighlight(type) {
					const targetElement = type === 'label'
						? domElements.radioList.querySelector('.govuk-radios__label')
						: domElements.radioList.querySelector('.govuk-radios__hint');

					if (targetElement) {
						targetElement.classList.remove('highlight');
					}
				}
			});
		</script>


		<script>
			document.addEventListener("DOMContentLoaded", function () {
				var secondContainer = document.getElementById("second-container");
				var borderLeftContainerRadios = document.getElementById("border-left-container-radios");

				if (secondContainer && borderLeftContainerRadios) {
					// Scroll the `borderLeftContainerTextarea` element into view within `second-container`
					borderLeftContainerRadios.scrollIntoView({
						behavior: "smooth",
						block: "nearest"
					});
					console.log("Scrolled to border-left-container-textarea within second-container");
				} else {
					console.log("second-container or border-left-container-textarea not found");
				}
			});

		</script>


		<style>
			.highlight {
				background-color: #ffe5cc;
				border-bottom: 2px solid #ffb266;
			}

			/* Styles for the reorderable list */
			.gem-c-reorderable-list {
				list-style-type: none;
				margin: 0;
				padding: 0;
			}

			.gem-c-reorderable-list__item {
				margin-bottom: 15px;
				border-left: 5px solid #008938;
				outline: 1px solid #b1b4b6;
				padding: 15px;
				background-color: #fff;
			}

			.gem-c-reorderable-list__wrapper {
				display: flex;
				align-items: center;
			}

			.gem-c-reorderable-list__content {
				flex-grow: 1;
			}

			.gem-c-reorderable-list__actions {
				display: none;
				/* Hide by default */
				flex-direction: column;
				margin-left: 15px;
			}

			.gem-c-reorderable-list__actions .govuk-button {
				margin-bottom: 5px;
			}

			.sortable-ghost {
				opacity: 0.4;
			}

			.sortable-chosen {
				background-color: #e5f5ff;
			}

			/* Style for hover state of the list item */
			.gem-c-reorderable-list__item:hover {
				background-color: #f0f0f0;
				cursor: move;
			}

			/* Style for the chosen item (when selected) */
			.gem-c-reorderable-list__item.sortable-chosen {
				background-color: #e5f5ff;
				outline: 4px solid #ffdd00;
				box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			}

			/* #before-content {
	position: absolute;
	top: 0;
	left: 10px !important;
	right: 0;
	width: 100%;
	padding: 10px !important;
	box-sizing: border-box;
	z-index: 1;
	border-bottom: 1px solid #008938;
	padding-left: 10px;
  } */

			#second-container {
				padding: 0;
				box-sizing: border-box;
			}

			#second-container>* {
				padding-left: 0px;
				z-index: 2;
			}

			.border-left-container {
				border-left: 10px solid #ffb266;
				padding-left: 20px;
			}
		</style>

		{% endblock %}