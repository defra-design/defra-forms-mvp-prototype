{% extends "layouts/main.html" %}
{% from "components/service-header/macro.njk" import serviceHeader %}
{% set pageName = "Edit file upload question - Apply for a county parish holding number in England" %}
{% set headingPlaceholder = "Page heading" %}
{% set guidancePlaceholder = "" %}

{% block header %}
  {{ serviceHeader({
    organisationName: "Defra",
    productName: "Forms Designer",
    serviceName: "",
    containerClasses: containerClasses,
    accountName: "Chris Smith",
    homepageLink: "/",
    signOutLink: "/onboarding/sign-out-confirmation",
    navigationItems: [
      { href: "/library.html", text: "Forms library", id: "nav-library" },
      { href: "/cph-overview/draft/complete-clean.html", text: "Overview", id: "nav-overview" },
      { href: "/redesigntest/listing", text: "Editor", id: "nav-editor" }    ],
    activeLinkId: "nav-editor"
  }) }}

<div class="x-govuk-masthead x-govuk-masthead--large">
  <div class="govuk-width-container">
    {{ govukBackLink({ classes: "govuk-back-link--inverse govuk-!-margin-bottom-0", text: "Back to add
    and edit pages", href: "/redesigntest/listing.html" }) }}

    <hr
      class="govuk-section-break govuk-section-break--m govuk-section-break--visible"
      style="border-bottom: 1px solid white; margin-bottom: 0"
    />

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds-from-desktop">
        <h1 class="x-govuk-masthead__title">
          <span class="govuk-caption-l" style="color: white">
            Apply for a county parish holding certificate
          </span>
          Edit page 2
        </h1>


      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="govuk-grid-row">
      <!-- Left Column for Form Controls -->
      <div class="govuk-grid-column-one-half-from-desktop" id="container" style="flex: 1 1 75%; overflow-y: auto">
        <div class="govuk-summary-card govuk-!-margin-top-0" style="border-left: 10px solid #008938">
          <div class="govuk-summary-card__content govuk-!-padding-top-0" style="background-color: #f3f2f1">
            <dl class="govuk-summary-list">
              <div class="govuk-summary-list__row">
                <dd class="govuk-summary-list__value">
                  <!-- Dynamic Summary List -->
                  <!-- Question Settings Container -->
                  <div class="govuk-grid-row" id="page-settings-container-1">
                    <div id="question-1">
                      <div class="govuk-summary-card__content" style="margin-bottom: 0">
                        <!-- Sub Navigation for Question -->
                        <nav class="moj-sub-navigation govuk-!-padding-top-0 govuk-!-margin-bottom-2 " aria-label="Sub navigation">
                          <ul class="moj-sub-navigation__list" id="nav-list2">
                            <!-- Question Link -->
                            <li class="moj-sub-navigation__item">
                              <a class="moj-sub-navigation__link" href="#question-1">Page settings</a>
                            </li>
                            <li class="moj-sub-navigation__item">
                              <a class="moj-sub-navigation__link" href="#overview-noquestions">Overview of questions</a>
                            </li>
                            <li class="moj-sub-navigation__item">
                              <a class="moj-sub-navigation__link" aria-current="page" href="#question-1-information-type">Question 7</a>
                            </li>
                          </ul>
                        </nav>

                        <div class="govuk-summary-card__title-wrapper govuk-!-padding-top-0"></div>

                        <span class="govuk-caption-l">Page 2</span>
                        <h2 class="govuk-heading-l">Question 7</h2>

                        <form method="post" id="options-form" action="/redesigntest/templates/more-than-1-question/fileupload/overview">
                          {% from "govuk/components/input/macro.njk" import govukInput %}


                          <!-- Question Label Input -->
                          <div class="govuk-form-group">
                            <label class="govuk-label--m" for="multi-question-label-input-file">
                              Question
                            </label>
                            <input class="govuk-input" id="multi-question-label-input-file" name="multiQuestionLabelInputFile"  type="text" value="">                          </div>

                          <!-- Hint Text Input -->
                          {{ govukTextarea({
                            label: {
                              text: "Hint text (optional)",
                              classes: "govuk-label--m"
                            },
                            id: "multi-question-hint-text-input-file",
                            name: "multiQuestionHintTextInputFile",
                            value: data['multi-question-hint-text-input-file'],
                            classes: "govuk-textarea",
                            rows: 3,
                            describedBy: "multi-question-hint-text-input-file"
                          }) }}

                          <!-- Make Optional Checkbox -->
                          <div class="govuk-form-group">
                            <div class="govuk-checkboxes--small">
                              <div class="govuk-checkboxes__item">
                                <input class="govuk-checkboxes__input" id="make-optional" name="makeOptional" type="checkbox" value="optional">
                                <label class="govuk-label govuk-checkboxes__label" for="make-optional">
                                  Make this question optional
                                </label>
                              </div>
                            </div>
                          </div>



    <!-- Answer Limits -->


      {% set documentsHtml %}
      {{ govukCheckboxes({
  name: "contactByDocuments",
  items: [
    {
      value: "documents",
      text: "Documents"
    }
  ]
}) }}
      {% endset -%}

      {% set imagesHtml %}
      {{ govukCheckboxes({
  name: "contactByImages",
  items: [
    {
      value: "images",
      text: "Images"
    }
  ]
}) }}
      {% endset -%}

      {% set tabularHtml %}
      {{ govukCheckboxes({
  name: "contactByTabular",
  items: [
    {
      value: "tabular",
      text: "Tabular data"
    }
  ]
}) }}
      {% endset -%}

      {% set documentslHtml %}
      {{ govukCheckboxes({
  name: "documentsOptions",
  items: [
    {
      value: "documents",
      text: "PDF"
    },
    {
      value: "doc",
      text: "DOC"
    },
    {
      value: "docx",
      text: "DOCX"
    },
    {
      value: "odt",
      text: "ODT"
    },
     {
      value: "txt",
      text: "TXT"
    }
  ]
}) }}
      {% endset -%}

      {% set imagesHtml %}
      {{ govukCheckboxes({
  name: "imagesOptions",
  items: [
    {
      value: "jpeg",
      text: "JPEG"
    },
    {
      value: "jpg",
      text: "JPG"
    },
    {
      value: "png",
      text: "PNG"
    }
  ]
}) }}
      {% endset -%}

      {% set tabularHtml %}
      {{ govukCheckboxes({
  name: "tabularOptions",
  items: [
    {
      value: "xls",
      text: "XLS"
    },
    {
      value: "xlsx",
      text: "XLSX"
    },
    {
      value: "csv",
      text: "CSV"
    },
    {
      value: "ods",
      text: "ODS"
    }
  ]
}) }}
      {% endset -%}

      {{ govukCheckboxes({
  name: "contact",
  fieldset: {
    legend: {
      text: "Select the file types you accept",
      isPageHeading: true,
      classes: "govuk-fieldset__legend--m"
    }
  },
  items: [
    {
      value: "documents",
      text: "Documents",
      conditional: {
        html: documentslHtml
      }
    },
    {
      value: "images",
      text: "Images",
      conditional: {
        html: imagesHtml
      }
    },
    {
      value: "tabular",
      text: "Tabular data",
      conditional: {
        html: tabularHtml
      }
    }
  ]
}) }}


{{ govukInput({
  label: {
    text: "Short description",
    classes: "govuk-label--m",
    isPageHeading: false
  },
  hint: {
    text: "Enter a short description for this question like 'licence period'. Short descriptions are used in error messages and on the check your answers page."
  },
  id: "error-message-input-shorttext",
  name: "errorMessageInputShorttext"
}) }}


<!-- Answer limits -->
<details class="govuk-details" data-module="govuk-details">
  <summary class="govuk-details__summary">
    <span class="govuk-details__summary-text">
     Set answer limits (optional)
    </span>
  </summary>
  <div class="govuk-details__text">
    <!-- Default Content for Question 1 -->
    <div id="question-1-content" class="question-content" style="margin-top: 10px;">

      <!-- Page Heading Input -->
      {% from "govuk/components/input/macro.njk" import govukInput %}

{{ govukInput({
  label: {
    text: "Minimum file count",
    classes: "govuk-label--m",
    isPageHeading: false
  },
  classes: "govuk-input--width-3",
  hint: {
    text: "The minimum number of files users can upload"
  },
  id: "min-files",
  name: "minFiles",
  inputmode: "numeric",
  spellcheck: false
}) }}

{{ govukInput({
  label: {
    text: "Maximum file count",
    classes: "govuk-label--m",
    isPageHeading: false
  },
  classes: "govuk-input--width-3",
  hint: {
    text: "The maximum number of files users can upload"
  },
  id: "min-files",
  name: "minFiles",
  inputmode: "numeric",
  spellcheck: false
}) }}
  </div>
</details>



<!-- Section Break -->
<hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

<!-- Question Settings Summary List -->
<h2 class="govuk-heading-m">Question settings</h2>

{{ govukSummaryList({
  "rows": [
    {
      "key": {
        "text": "Type of information"
      },
      "value": {
        "html": "Supporting evidence"
      },
      "actions": {
        "items": [
          {
            "href": "/redesigntest/templates/1-question/information-type.html",
            "text": "Change",
            "visuallyHiddenText": " type"
          }
        ]
      }
    }
  ]
}) }}

<hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">


                          <!-- Other form elements... -->

                          <!-- Submit Button -->
                          <div class="moj-button-action">
                            {{ govukButton({
                              text: 'Continue',
                              type: 'submit'
                            }) }}
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </dd>
              </div>
            </dl>
          </div>
        </div>
      </div>

      <!-- Right Column for Preview -->
      <div class="govuk-grid-column-one-half-from-desktop" id="second-container" style="outline: solid 1px #008938; height: 100vh;overflow-y: auto; position: sticky; top: 0; padding: 20px; box-shadow: 5px 10px #008938;">
        <!-- Before content -->
        <div id="before-content">
          <p class="govuk-body-s" style="margin-bottom: 0">
            <a href="#" class="govuk-link govuk-link--no-visited-state" rel="noreferrer noopener" target="_blank">Preview this page in a new tab</a>
          </p>
        </div>

        {% include "/redesigntest/templates/previews-more-than-1-question/textarea/overview.html" %}
        {% include "/redesigntest/templates/previews-more-than-1-question/numbers/for-overview.html" %}
        {% include "/redesigntest/templates/previews-more-than-1-question/date/for-overview.html" %}

        {% include "/redesigntest/templates/previews-more-than-1-question/address/for-overview.html" %}

        {% include "/redesigntest/templates/previews-more-than-1-question/phone/for-overview.html" %}

        <div id="border-left-container-file" name="borderLeftContainerFile"
        {% include "/redesigntest/templates/previews-more-than-1-question/fileupload/edit.html" %}

      </div>
  </div>
  </div>

 <!-- JavaScript code -->
 <script>
  document.addEventListener('DOMContentLoaded', function () {
    // DOM Elements
    const domElements = {
      // Existing elements
      multiQuestionLabelInputFile: document.getElementById('multi-question-label-input-file'),
      multiQuestionLabelLegendFile: document.getElementById('multi-question-label-legend-file'),
      multiQuestionHintTextInputFile: document.getElementById('multi-question-hint-text-input-file'),
      multiQuestionHintTextOutputFile: document.getElementById('multi-question-hint-text-output-file'),
      makeOptionalCheckbox: document.getElementById('make-optional'),
    };

    // Initialize event listeners
    initializeEventListeners();

    function initializeEventListeners() {
    // Update question label
    if (domElements.multiQuestionLabelInputFile && domElements.multiQuestionLabelLegendFile) {
      domElements.multiQuestionLabelInputFile.addEventListener('input', updateQuestionLabel);
    }

       // Update hint text and handle placeholder
       if (domElements.multiQuestionHintTextInputFile && domElements.multiQuestionHintTextOutputFile) {
      domElements.multiQuestionHintTextInputFile.addEventListener('input', updateHintText);
      domElements.multiQuestionHintTextInputFile.addEventListener('focus', showPlaceholderHint);
      domElements.multiQuestionHintTextInputFile.addEventListener('blur', clearPlaceholderHint);
    }

      // Update optional label
      if (domElements.makeOptionalCheckbox) {
        domElements.makeOptionalCheckbox.addEventListener('change', updateQuestionLabel);
      }

      // Update page heading
      if (domElements.pageHeadingInputFile && domElements.dynamicHeading) {
        domElements.pageHeadingInputFile.addEventListener('input', updatePageHeading);
      }

// Apply focus/blur highlighting
applyHighlightOnFocus(domElements.multiQuestionLabelInputFile, domElements.multiQuestionLabelLegendFile);
    applyHighlightOnFocus(domElements.multiQuestionHintTextInputFile, domElements.multiQuestionHintTextOutputFile);
    applyHighlightOnFocus(domElements.pageHeadingInputFile, domElements.dynamicHeading);
    applyHighlightOnFocus(domElements.guidanceFile, domElements.guidanceParagraph);
  }
  function updateQuestionLabel() {
    const suffix = domElements.makeOptionalCheckbox.checked ? ' (optional)' : '';
    domElements.multiQuestionLabelLegendFile.textContent = domElements.multiQuestionLabelInputFile.value || 'Question';
    domElements.multiQuestionLabelLegendFile.textContent += suffix;
  }

  function updateHintText() {
    domElements.multiQuestionHintTextOutputFile.textContent = domElements.multiQuestionHintTextInputFile.value;
  }

  function updatePageHeading() {
    domElements.dynamicHeading.textContent = domElements.pageHeadingInputFile.value;
  }

    function updateGuidanceText() {
      domElements.guidanceParagraph.textContent = domElements.guidanceFile.value;
    }

    function applyHighlightOnFocus(inputElement, targetElement) {
      if (inputElement && targetElement) {
        inputElement.addEventListener('focus', function () {
          targetElement.classList.add('highlight');
        });
        inputElement.addEventListener('blur', function () {
          targetElement.classList.remove('highlight');
        });

        // If the input is already focused
        if (document.activeElement === inputElement) {
          targetElement.classList.add('highlight');
        }
      }
    }

// Placeholder handling for hint text
  function showPlaceholderHint() {
    if (!domElements.multiQuestionHintTextInputFile.value) {
      domElements.multiQuestionHintTextOutputFile.textContent = 'Hint text';
    }
  }

  function clearPlaceholderHint() {
    if (!domElements.multiQuestionHintTextInputFile.value) {
      domElements.multiQuestionHintTextOutputFile.textContent = '';
    }
  }

  // Placeholder handling for page heading
  function showPlaceholderHeading() {
    if (!domElements.pageHeadingInputFile.value) {
      domElements.dynamicHeading.textContent = 'Page heading';
    }
  }

  function clearPlaceholderHeading() {
    if (!domElements.pageHeadingInputFile.value) {
      domElements.dynamicHeading.textContent = '';
    }
  }

  // Placeholder handling for guidance text
  function showPlaceholderGuidance() {
    if (!domElements.guidanceFile.value) {
      domElements.guidanceParagraph.textContent = 'Guidance text';
    }
  }

  function clearPlaceholderGuidance() {
    if (!domElements.guidanceFile.value) {
      domElements.guidanceParagraph.textContent = '';
    }
  }

  });
  </script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
      var secondContainer = document.getElementById("second-container");
      var borderLeftContainerFile= document.getElementById("border-left-container-file");

      if (secondContainer && borderLeftContainerFile) {
          // Scroll the `borderLeftContainerTextarea` element into view within `second-container`
          borderLeftContainerFile.scrollIntoView({
              behavior: "smooth",
              block: "nearest"
          });
          console.log("Scrolled to border-left-container-textarea within second-container");
      } else {
          console.log("second-container or border-left-container-textarea not found");
      }
  });

    </script>


<!-- CSS for Highlighting -->
<style>
.highlight {
  background-color: #ffe5cc;
  border-bottom: 2px solid #ffb266;
}

#before-content {
  position: absolute;
  top: 0;
  left: 10 !important;
  right: 0;
  width: 100%;
  padding: 10px !important;
  box-sizing: border-box;
  z-index: 1;
  border-bottom: 1px solid #008938;
  padding-left: 10px;
}

#second-container {
  padding: 0;
  box-sizing: border-box;
}

#second-container > * {
  padding-left: 0px;
  z-index: 2;
}
</style>
</div>
</div>
{% endblock %}
