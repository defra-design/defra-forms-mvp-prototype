{% extends "layouts/main.html" %}
{% from "components/service-header/macro.njk" import serviceHeader %}
{% set pageName = "Overview of date question - Apply for a county parish holding number in England" %}
{% set headingPlaceholder = "Page heading" %}
{% set guidancePlaceholder = "" %}

{% block header %}
  {{ serviceHeader({
    organisationName: "Defra",
    productName: "Forms Designer",
    serviceName: "",
    containerClasses: containerClasses,
    accountName: "Chris Smith",
    homepageLink: "/",
    signOutLink: "/onboarding/sign-out-confirmation",
    navigationItems: [
      { href: "/library.html", text: "Forms library", id: "nav-library" },
      { href: "/cph-overview/draft/complete-clean.html", text: "Overview", id: "nav-overview" },
      { href: "/redesigntest/listing", text: "Editor", id: "nav-editor" }    ],
    activeLinkId: "nav-editor"
  }) }}

<div class="x-govuk-masthead x-govuk-masthead--large">
  <div class="govuk-width-container">
    {{ govukBackLink({ classes: "govuk-back-link--inverse govuk-!-margin-bottom-0", text: "Back to add
    and edit pages", href: "/redesigntest/listing.html" }) }}

    <hr
      class="govuk-section-break govuk-section-break--m govuk-section-break--visible"
      style="border-bottom: 1px solid white; margin-bottom: 0"
    />

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full-from-desktop">
        <h1 class="x-govuk-masthead__title">
          {# <span class="govuk-caption-l" style="color: white">
            Apply for a county parish holding certificate
          </span> #}
          Apply for a county parish holding (CPH) number
        </h1>

        {# #}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="govuk-grid-row">
      <!-- Left Column for Form Controls -->
      <div class="govuk-grid-column-one-half-from-desktop" id="container" style="flex: 1 1 75%; overflow-y: auto">
        <div class="govuk-summary-card govuk-!-margin-top-0" style="border-left: 10px solid #008938">
          <div class="govuk-summary-card__content govuk-!-padding-top-0" style="background-color: #f3f2f1">
            <dl class="govuk-summary-list">
              <div class="govuk-summary-list__row">
                <dd class="govuk-summary-list__value">
                  <!-- Dynamic Summary List -->
                  <!-- Question Settings Container -->
                  <div class="govuk-grid-row" id="page-settings-container-1">
                    <div id="question-1">
                      <div class="govuk-summary-card__content" style="margin-bottom: 0">
                        <!-- Sub Navigation for Question -->
                        <nav class="moj-sub-navigation govuk-!-padding-top-0 govuk-!-margin-bottom-2 " aria-label="Sub navigation">
                          <ul class="moj-sub-navigation__list" id="nav-list2">
                            <!-- Question Link -->
                            <li class="moj-sub-navigation__item">
                              <a class="moj-sub-navigation__link" href="#question-1">Page settings</a>
                            </li>
                            <li class="moj-sub-navigation__item">
                              <a class="moj-sub-navigation__link" aria-current="page"  href="#overview-noquestions">Overview of questions</a>
                            </li>

                          </ul>
                        </nav>

                        <div class="govuk-summary-card__title-wrapper govuk-!-padding-top-0"></div>

                        <span class="govuk-caption-l" id="page-caption">Page 2</span>

                        <h2 class="govuk-heading-l" id="page-heading">Overview of questions</h2>


                        <form class="form" action="/redesigntest/Multi/question-2-date/information-type" method="post">

                           <!-- Dynamic Summary List -->
            <div id="summary-container">
              <!-- The dynamic summary list will be populated here -->

              {{ govukSummaryList({
                classes: "govuk-summary-list govuk-section-break govuk-section-break--visible",
                rows: [
                  {
                    key: {
                      text: "Question 1"
                    },
                    value: {
                      html: data['multiQuestionLabelInputShorttext'] or ''

                    },
                    actions: {
                      items: [
                        {
                                                    href: "/redesigntest/templates/1-question/shorttext/edit.html",
                          text: "Change",
                          visuallyHiddenText: "name"
                        }
                        ]
                      }
                    },

                    {
                      key: {
                        text: "Question 2"
                      },
                      value: {
                        html: data['multiQuestionLabelInputTextArea'] or ''

                      },
                      actions: {
                        items: [
                          {
                                                      href: "/redesigntest/templates/1-question/shorttext/edit.html",
                            text: "Change",
                            visuallyHiddenText: "name"
                          }
                          ]
                        }
                      },
                      {
                        key: {
                          text: "Question 3"
                        },
                        value: {
                          html: data['multiQuestionLabelInputNumbers'] or ''
                        },
                        actions: {
                          items: [
                            {
                                                        href: "/redesigntest/templates/1-question/shorttext/edit.html",
                              text: "Change",
                              visuallyHiddenText: "name"
                            }
                            ]
                          }
                        },
                        {
                          key: {
                            text: "Question 4"
                          },
                          value: {
                            html: data['multiQuestionLabelInputDate'] or ''
                          },
                          actions: {
                            items: [
                              {
                                                          href: "/redesigntest/templates/1-question/shorttext/edit.html",
                                text: "Change",
                                visuallyHiddenText: "name"
                              }
                              ]
                            }
                          }
                        ]

              }) }}


            </div>
                        </form>

                        <div class="govuk-button-group govuk-!-margin-top-6">


                          <a href="/redesigntest/templates/more-than-1-question/date/information-type.html" class="govuk-button" role="button">
                            Add next question
                          </a>

                          <button id="reorder-questions-button" class="govuk-button govuk-button--inverse" type="button">
                            Re-order questions
                          </button>

                          <a href="/redesigntest/listing.html" id="back-link-button" class="govuk-link govuk-link--no-visited-state" role="button">
                            Back to all pages
                          </a>
                        </div>


                      </div>
                    </div>
                  </div>
                </dd>
              </div>
            </dl>
          </div>
        </div>
      </div>

    <!-- Right Column for Preview -->
    <div class="govuk-grid-column-one-half-from-desktop" id="second-container" style="outline: solid 1px #008938; height: 100vh; overflow-y: auto; position: sticky; top: 0; padding: 20px; box-shadow: 5px 10px #008938;">
      <!-- Before content -->
      <div id="before-content" style=" background-color:  #cce2d8;">
        <p class="govuk-body-s" style="margin-bottom: 0; color: #005a30; padding: 2px 8px 3px;
  text-align: center;" > Previews
        </p>
      </div>

      <div style="margin-top: 60px;">
        {% from "govuk/components/tabs/macro.njk" import govukTabs %}

        <div class="govuk-tabs" data-module="govuk-tabs">
          <h2 class="govuk-tabs__title">
            Contents
          </h2>
          <ul class="govuk-tabs__list">
            <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
              <a class="govuk-tabs__tab" href="#tab-one">Page preview</a>
            </li>

          </ul>

          <div class="govuk-tabs__panel" id="tab-one">
            <!-- Page Preview Content -->


            <p class="govuk-body-s" style="margin-bottom: 30px; border-bottom: #008938 1px;">
              <a href="#" class="govuk-link govuk-link--no-visited-state" rel="noreferrer noopener" target="_blank">
                Preview this page in a new tab
              </a>


        {% include "/redesigntest/templates/previews-more-than-1-question/textarea/overview.html" %}

        {% include "/redesigntest/templates/previews-more-than-1-question/numbers/for-overview.html" %}
        <!-- Include the preview template -->
        {% include "/redesigntest/templates/previews-more-than-1-question/date/for-overview.html" %}

        {% include "/redesigntest/templates/more-than-1-question/previews/button.html" %}
      </div>
    </div>

    <!-- JavaScript code -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // DOM Elements
        const domElements = {
          // Existing elements
          questionLabelInput: document.getElementById('question-label-input'),
          questionLabelLegend: document.getElementById('question-label-legend'),
          hintTextInput: document.getElementById('hint-text-input'),
          hintTextOutput: document.getElementById('hint-text-output'),
          makeOptionalCheckbox: document.getElementById('make-optional'),

          // New elements for page heading and guidance text
          pageHeadingInput: document.getElementById('page-heading-input'),
          dynamicHeading: document.getElementById('dynamic-heading'),
          guidanceTextarea: document.getElementById('guidance-textarea'),
          guidanceParagraph: document.getElementById('guidance-paragraph')
        };

        // Initialize event listeners
        initializeEventListeners();

        function initializeEventListeners() {
          // Update question label
          if (domElements.questionLabelInput && domElements.questionLabelLegend) {
            domElements.questionLabelInput.addEventListener('input', updateQuestionLabel);
          }

          // Update hint text
          if (domElements.hintTextInput && domElements.hintTextOutput) {
            domElements.hintTextInput.addEventListener('input', updateHintText);
          }

          // Update optional label
          if (domElements.makeOptionalCheckbox) {
            domElements.makeOptionalCheckbox.addEventListener('change', updateQuestionLabel);
          }

          // Update page heading
          if (domElements.pageHeadingInput && domElements.dynamicHeading) {
            domElements.pageHeadingInput.addEventListener('input', updatePageHeading);
          }

          // Update guidance text
          if (domElements.guidanceTextarea && domElements.guidanceParagraph) {
            domElements.guidanceTextarea.addEventListener('input', updateGuidanceText);
          }

          // Apply focus/blur highlighting
          applyHighlightOnFocus(domElements.questionLabelInput, domElements.questionLabelLegend);
          applyHighlightOnFocus(domElements.hintTextInput, domElements.hintTextOutput);
          applyHighlightOnFocus(domElements.pageHeadingInput, domElements.dynamicHeading);
          applyHighlightOnFocus(domElements.guidanceTextarea, domElements.guidanceParagraph);
        }

        function updateQuestionLabel() {
          const suffix = domElements.makeOptionalCheckbox.checked ? ' (optional)' : '';
          domElements.questionLabelLegend.textContent = domElements.questionLabelInput.value || 'Question';
          domElements.questionLabelLegend.textContent += suffix;
        }

        function updateHintText() {
          domElements.hintTextOutput.textContent = domElements.hintTextInput.value;
        }

        function updatePageHeading() {
          domElements.dynamicHeading.textContent = domElements.pageHeadingInput.value;
        }

        function updateGuidanceText() {
          domElements.guidanceParagraph.textContent = domElements.guidanceTextarea.value;
        }

        function applyHighlightOnFocus(inputElement, targetElement) {
          if (inputElement && targetElement) {
            inputElement.addEventListener('focus', function () {
              targetElement.classList.add('highlight');
            });
            inputElement.addEventListener('blur', function () {
              targetElement.classList.remove('highlight');
            });

            // If the input is already focused
            if (document.activeElement === inputElement) {
              targetElement.classList.add('highlight');
            }
          }
        }
      });
      </script>


    <!-- CSS for Highlighting -->
    <style>
      .highlight {
        background-color: #ffe5cc;
        border-bottom: 2px solid #ffb266;
      }

      #before-content {
        position: absolute;
        top: 0;
        left: 10 !important;
        right: 0;
        width: 100%;
        padding: 10px !important;
        box-sizing: border-box;
        z-index: 1;
        border-bottom: 1px solid #008938;
        padding-left: 10px;
      }

      #second-container {
        padding: 0;
        box-sizing: border-box;
      }

      #second-container > * {
        padding-left: 0px;
        z-index: 2;
      }
    </style>
  </div>
</div>
{% endblock %}
