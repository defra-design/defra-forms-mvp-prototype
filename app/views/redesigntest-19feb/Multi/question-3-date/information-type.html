{% extends "layouts/main.html" %}
{% from "components/service-header/macro.njk" import serviceHeader %}
{% set pageName = "Edit page 1 - Apply for a county parish holding number in England" %}
{% set headingPlaceholder = "Page heading" %}
{% set guidancePlaceholder = "" %}
{#  #}
{% block header %}
  {{ serviceHeader({
    organisationName: "Defra",
    productName: "Forms Designer",
    serviceName: "",
    containerClasses: containerClasses,
    accountName: "Chris Smith",
    homepageLink: "/",
    signOutLink: "/onboarding/sign-out-confirmation",
    navigationItems: [
      { href: "/library.html", text: "Forms library", id: "nav-library" },
      { href: "/cph-overview/draft/complete-clean.html", text: "Overview", id: "nav-overview" },
      { href: "/redesigntest/listing", text: "Editor", id: "nav-editor" }    ],
    activeLinkId: "nav-editor"
  }) }}

<div class="x-govuk-masthead x-govuk-masthead--large">
  <div class="govuk-width-container">
    {{ govukBackLink({ classes: "govuk-back-link--inverse", text: "Back to add
    and edit pages", href: "/september/listing/2.html" }) }}

    <hr
      class="govuk-section-break govuk-section-break--m govuk-section-break--visible"
      style="border-bottom: 1px solid white; margin-bottom: 0"
    />

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds-from-desktop">
        <h1 class="x-govuk-masthead__title">
          <span class="govuk-caption-l" style="color: white"
            >Apply for a county parish holding certificate</span
          >

          Edit page 2
        </h1>

        <p class="govuk-body" style="color: white">Last saved at <time>5:24pm</time></p>

      </div>
    </div>
  </div>
</div>

{% endblock %} {% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="govuk-grid-row">
      <!-- Left Column for Form Controls -->
      <div
        class="govuk-grid-column-one-half-from-desktop"
        id="container"
        style="flex: 1 1 75%; overflow-y: auto"
      >
        <div class="govuk-summary-card govuk-!-margin-top-0" style="border-left: 10px solid #008938">
          <div
            class="govuk-summary-card__content govuk-!-padding-top-0"
            style="background-color: #f3f2f1"
          >

            <dl class="govuk-summary-list">
              <div class="govuk-summary-list__row">
                <dd class="govuk-summary-list__value">
                  <!-- Dynamic Summary List -->

                  <!-- Question Settings Container -->
                  <div class="govuk-grid-row" id="page-settings-container-1">
                    <div id="question-1">
                      <div
                        class="govuk-summary-card__content"
                        style="margin-bottom: 0"
                      >
                        <!-- Sub Navigation for Question -->
                        <nav
                          class="moj-sub-navigation govuk-!-padding-top-0 govuk-!-margin-bottom-2 "
                          aria-label="Sub navigation"
                        >
                          <ul class="moj-sub-navigation__list" id="nav-list2">
                            <!-- Question Link -->
                            <li class="moj-sub-navigation__item">
                              <a
                                class="moj-sub-navigation__link"
                                href="#question-1"
                                >Page settings</a
                              >
                            </li>

                            <li class="moj-sub-navigation__item">
                              <a
                                class="moj-sub-navigation__link"
                                href="#overview-noquestions"
                                >Overview of questions</a
                              >
                            </li>

                            <li class="moj-sub-navigation__item">
                              <a
                                class="moj-sub-navigation__link"
                                aria-current="page"
                                href="#question-1-information-type"
                                >Question 1</a
                              >
                            </li>

                          </ul>
                        </nav>

                        <div
                          class="govuk-summary-card__title-wrapper govuk-!-padding-top-0"
                        ></div>

                        <form class="form" action="/redesigntest/Multi/question-3-date/add-content" method="post">


                        {% set dateHtml %}
                        {{ govukRadios({
                          name: "dateType",
                          fieldset: {
                            legend: {
                              text: "Type of date",
                              isPageHeading: true,
                              classes: "govuk-fieldset__legend"
                            }
                          },
                          items: [
                            {
                              value: "day-month-year",
                              text: "Day, month and year"
                            },
                            {
                              value: "month-year",
                              text: "Month and year"
                            }
                          ]
                        }) }}
                      {% endset -%}

                      {% set writtenHtml %}
                        {{ govukRadios({
                          name: "written",
                          fieldset: {
                            legend: {
                              text: "Type of written answer"
                            }
                          },
                          items: [
                            {
                              value: data["short-answer"],
                              text: "Short answer"
                            },
                            {
                              value: data["long-answer"],
                              text: "Long answer"
                            }
                          ]
                        }) }}
                      {% endset -%}

                      {% set list2Html %}
                        {{ govukRadios({
                          name: "listType",
                          fieldset: {
                            legend: {
                              text: "Type of list",
                              classes: "govuk-fieldset__legend"
                            }
                          },
                          items: [
                            {
                              value: "yes-no",
                              text: "Yes or No",
                              hint: {
                                text: "Allow users to answer either ‘Yes’ or ‘No’"
                              }
                            },
                            {
                              value: "checkboxes",
                              text: "Checkboxes",
                              hint: {
                                text: "A list for users to select multiple answers"
                              }
                            },
                            {
                              value: "radios",
                              text: "Radios",
                              hint: {
                                text: "A list for users to select one answer"
                              }
                            },
                            {
                              value: "select",
                              text: "Select",
                              hint: {
                                text: "A drop-down list for users to select one answer"

                          }
                        }
                          ]
                        }) }}
                      {% endset -%}

                      {{ govukRadios({
                        name: "informationQuestion",
                        fieldset: {
                          legend: {
                            text: "What information do you need from users?",
                            isPageHeading: true,
                            classes: "govuk-fieldset__legend--l"
                          }
                        },
                        hint: {
                          text: "You can ask for more information later"
                        },
                        items: [
                          {
                            value: "text",
                            text: "Written answer",
                            hint: {
                              text: "A short or long answer as text or number"
                            },
                            conditional: {
                              html: writtenHtml
                            }
                          },
                          {
                            value: "date",
                            text: "Date",
                            hint: {
                              text: "A day, month and year or month and year only"
                            },
                            conditional: {
                              html: dateHtml
                            }
                          },
                          {
                            value: data["address"],
                            text: "UK address",
                            hint: {
                              text: "A street address, town or city and postcode"
                            }
                          },
                          {
                            value: data["phone"],
                            text: "Phone number",
                            hint: {
                              text: "A text box that users can enter numbers and some symbols into, such as '+'"
                            }
                          },
                          {
                            value: data["file"],
                            text: "Supporting evidence",
                            hint: {
                              text: "Ask users to upload documents and photos"
                            }
                          },
                          {
                            value: data["email"],
                            text: "Email address",
                            hint: {
                              text: "A text box that users can enter their email address into"
                            }
                          },
                          {
                            divider: "or"
                          },
                          {
                            value: data["list"],
                            text: "A list of options that users can choose from",
                            conditional: {
                              html: list2Html
                            }
                          }
                        ]
                      }) }}

  {{ govukButton({
    text: "Continue",
    id: "add-question-button"
  }) }}


</div></div></div></div></div></div></div>

      <!-- Right Column for Additional Content -->
      <div
      class="govuk-grid-column-one-half-from-desktop"
      id="second-container"
      style="
        outline: solid 1px #008938;
        height: 100%;
        position: sticky;
        top: 0;
        padding: 20px;
        box-shadow: 5px 10px #008938;
      "
    >
      <!-- New HTML content for before element -->
      <div id="before-content">
        <p class="govuk-body-s" style="margin-bottom: 0">
          <a
            href="#"
            class="govuk-link govuk-link--no-visited-state"
            rel="noreferrer noopener"
            target="_blank"
            >Preview this page in a new tab</a
          >
        </p>
      </div>

      <!-- Additional Content Here -->
      <div class="additional-content">

        <div>
          <!-- Tag for Preview -->
          {{ govukTag({ text: "Preview of page 2", classes: "govuk-tag--yellow
          govuk-!-margin-bottom-2 govuk-!-margin-top-8" }) }}
          <!-- Form for Preview -->
          <form>
 <!-- Dynamic Heading -->



 <div id="heading-container">
  <span id="dynamic-caption" class="govuk-caption-l">{{ (data['setName'] or '') + ' 1' }}</span>


 <h1 class="govuk-heading-l" id="dynamic-heading">{{ data['pageHeading'] or '' }}</h1>

 </div>

 <!-- Guidance Paragraph -->
 <p class="govuk-body" id="guidance-paragraph">{{ data['guidanceText'] or '' }}</p>

 {% from "govuk/components/radios/macro.njk" import govukRadios %}



 <div class="govuk-form-group"></div>
 <fieldset class="govuk-fieldset">
  <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
    <h1 class="govuk-fieldset__heading">
      {{ data['questionLabelInputq1'] or '' }}
    </h1>
  </legend>

  <div class="govuk-radios" data-module="govuk-radios">
    <!-- English Longhorn -->
    <div class="govuk-radios__item">
      <input
        class="govuk-radios__input"
        id="breed-1"
        name="breed"
        type="radio"
        value="english-longhorn"
      >
      <label class="govuk-label govuk-radios__label" for="breed-1">
        English Longhorn
      </label>
    </div>

    <!-- Red Poll -->
    <div class="govuk-radios__item">
      <input
        class="govuk-radios__input"
        id="breed-2"
        name="breed"
        type="radio"
        value="red-poll"
      >
      <label class="govuk-label govuk-radios__label" for="breed-2">
        Red Poll
      </label>
    </div>

    <!-- White Park -->
    <div class="govuk-radios__item">
      <input
        class="govuk-radios__input"
        id="breed-3"
        name="breed"
        type="radio"
        value="white-park"
      >
      <label class="govuk-label govuk-radios__label" for="breed-3">
        White Park
      </label>
    </div>

    <!-- Hereford -->
    <div class="govuk-radios__item">
      <input
        class="govuk-radios__input"
        id="breed-4"
        name="breed"
        type="radio"
        value="hereford"
      >
      <label class="govuk-label govuk-radios__label" for="breed-4">
        Hereford
      </label>
    </div>

    <!-- Highland -->
    <div class="govuk-radios__item">
      <input
        class="govuk-radios__input"
        id="breed-5"
        name="breed"
        type="radio"
        value="highland"
      >
      <label class="govuk-label govuk-radios__label" for="breed-5">
        Highland
      </label>
    </div>
  </div>




    <!-- Date Input Group -->
    <div class="govuk-form-group govuk-!-margin-top-6">
     <fieldset class="govuk-fieldset" role="group">
       <legend class="govuk-fieldset__legend govuk-fieldset__legend--m" id="date-input-legend-q2">{{ data['questionLabelInputQ2'] or '' }}
       </legend>
       <div class="govuk-form-group">
         <!-- Date Input Hint -->
         <div id="date-input-hint" name="dateinputhint1" class="govuk-hint"></div>
         <!-- Date Input Fields -->
         <div class="govuk-date-input" id="date-input" data-module="govuk-date-input">
           <!-- Day Input -->
           <div class="govuk-date-input__item" id="day-input-wrapper">
             <div class="govuk-form-group">
               <label class="govuk-label govuk-date-input__label" for="date-day">Day</label>
               <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="date-day"
                 name="date-day" type="text">
             </div>
           </div>
           <!-- Month Input -->
           <div class="govuk-date-input__item" id="month-input-wrapper">
             <div class="govuk-form-group">
               <label class="govuk-label govuk-date-input__label" for="date-month">Month</label>
               <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="date-month"
                 name="date-month" type="text" pattern="[0-9]*">
             </div>
           </div>
           <!-- Year Input -->
           <div class="govuk-date-input__item" id="year-input-wrapper">
             <div class="govuk-form-group">
               <label class="govuk-label govuk-date-input__label" for="date-year">Year</label>
               <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="date-year"
                 name="date-year" type="text" pattern="[0-9]*">
             </div>
           </div>
         </div>
       </div>
     </fieldset>
   </div>
 </form>
 {{ govukButton({
  text: "Add another cow",
  classes: "govuk-button govuk-!-margin-top-3",
  id: "add-another-set-button",
  disabled: true
}) }}
           </div>
         </div>
       </div>
     </div>


   <script>
  document.addEventListener("DOMContentLoaded", function () {
    const domElements = {
      moreThanOnceRadio: document.getElementById("more-than-1"),
      onceRadio: document.getElementById("once"),
      addAnotherSetButton: document.getElementById("add-another-set-button"),
      onceButton: document.getElementById("once-button"),
      setNameInput: document.getElementById("set-name"),
      dynamicCaption: document.getElementById("dynamic-caption"),

      // Elements from the second script
      questionLabelInput: document.getElementById("question-label-input-1"),
      shortTextLabel: document.getElementById("short-text-label"),
      hintTextArea: document.getElementById("hint-text-input"),
      hintDiv: document.getElementById("date-input-hint"),
      errorLabelInput: document.getElementById("error-label-input"),
      errorDynamicText: document.getElementById("error-dynamic-text"),
      pageHeadingInput: document.getElementById("page-heading-input"),
      guidanceTextarea: document.getElementById("guidance-textarea"),
      dynamicHeading: document.getElementById("dynamic-heading"),
      guidanceParagraph: document.getElementById("guidance-paragraph"),
    };

    initializeEventListeners();

    function initializeEventListeners() {
      // First script event listeners
      domElements.moreThanOnceRadio.addEventListener("change", toggleCaptionAndButtons);
      domElements.onceRadio.addEventListener("change", toggleCaptionAndButtons);
      domElements.setNameInput.addEventListener("input", updateDynamicCaptionAndHeading);

      // Second script event listeners
      const inputListeners = [
        { element: domElements.questionLabelInput, event: "input", handler: updateQuestionLabel },
        { element: domElements.hintTextArea, event: "input", handler: updateHintText },
        { element: domElements.errorLabelInput, event: "input", handler: updateErrorDynamicText },
        { element: domElements.pageHeadingInput, event: "input", handler: updateHeading },
        { element: domElements.guidanceTextarea, event: "input", handler: updateGuidanceParagraph },
      ];

      inputListeners.forEach(bindListener);

      // Initialize state on page load
      toggleCaptionAndButtons(); // Ensure correct initial state
      updateAddAnotherSetButton();
      updateHeading();
      updateGuidanceParagraph();
      applyHighlights();
    }

    // First script functionality
    function toggleCaptionAndButtons() {
      if (domElements.moreThanOnceRadio.checked) {
        showCaptionWithPlaceholder();
        domElements.addAnotherSetButton.style.display = "inline-block";
        domElements.onceButton.style.display = "none";
      } else if (domElements.onceRadio.checked) {
        hideCaptionAndClearInput();
        domElements.addAnotherSetButton.style.display = "none";
        domElements.onceButton.style.display = "inline-block";
      }

      // Ensure the 'once-button' is always disabled unless conditions change
      domElements.onceButton.disabled = true;
    }

    function updateDynamicCaptionAndHeading() {
      const setName = domElements.setNameInput.value.trim();
      domElements.dynamicCaption.textContent = setName ? `${setName} 1` : "Question set name";
      domElements.dynamicCaption.style.display = setName ? "block" : "none";
      updateAddAnotherSetButton(); // Ensure buttons are updated when setName changes
    }

    function updateAddAnotherSetButton() {
      const setName = domElements.setNameInput.value.trim();
      if (setName && domElements.moreThanOnceRadio.checked) {
        domElements.addAnotherSetButton.textContent = `Add another ${setName}`;
        domElements.addAnotherSetButton.disabled = false;
      } else {
        domElements.addAnotherSetButton.textContent = "Add another [question set name]";
        domElements.addAnotherSetButton.disabled = true;
      }

      // Ensure that 'once-button' is kept disabled, unless 'once' is selected
      if (domElements.onceRadio.checked) {
        domElements.onceButton.disabled = false;
      } else {
        domElements.onceButton.disabled = true;
      }
    }

    function showCaptionWithPlaceholder() {
      domElements.dynamicCaption.textContent = "Question set name";
      domElements.dynamicCaption.style.display = "block";
    }

    function hideCaptionAndClearInput() {
      domElements.dynamicCaption.style.display = "none";
    }

    // Second script functionality
    function updateQuestionLabel() {
      setTextContent(domElements.shortTextLabel, domElements.questionLabelInput.value.trim(), "Question 1");
    }

    function updateHintText() {
      setTextContent(domElements.hintDiv, domElements.hintTextArea.value.trim(), "");
    }

    function updateErrorDynamicText() {
      setTextContent(domElements.errorDynamicText, domElements.errorLabelInput.value.trim(), "date of birth");
    }

    function updateHeading() {
      setTextContent(domElements.dynamicHeading, domElements.pageHeadingInput.value.trim(), "Page heading");
    }

    function updateGuidanceParagraph() {
      setTextContent(domElements.guidanceParagraph, domElements.guidanceTextarea.value.trim(), "");
    }

    // Generic function to update text content
    function setTextContent(element, value, defaultValue) {
      if (element) {
        element.textContent = value || defaultValue;
      }
    }

    // Helper to bind event listeners
    function bindListener({ element, event, handler }) {
      if (element) {
        element.addEventListener(event, handler);
      }
    }

    // Apply focus/blur highlights
    function applyHighlights() {
      const highlightPairs = [
        { inputId: "question-label-input-1", targetId: "short-text-label" },
        { inputId: "hint-text-input", targetId: "date-input-hint" },
        { inputId: "optional", targetId: "date-input-legend" },
        { inputId: "page-heading-input", targetId: "dynamic-heading" },
        { inputId: "guidance-textarea", targetId: "guidance-paragraph" },
        { inputId: "error-label-input", targetId: "error-dynamic-text" },

        // 'set-name' input highlighting
        { inputId: "set-name", targetId: "dynamic-caption" },
      ];

      highlightPairs.forEach(({ inputId, targetId }) => {
        applyHighlightOnFocus(inputId, targetId);
      });
    }

    // Helper function for applying focus and blur highlights
    function applyHighlightOnFocus(inputElementId, targetElementId) {
      const inputElement = document.getElementById(inputElementId);
      const targetElement = document.getElementById(targetElementId);

      if (inputElement && targetElement) {
        inputElement.addEventListener("focus", () => targetElement.classList.add("highlight"));
        inputElement.addEventListener("blur", () => targetElement.classList.remove("highlight"));
      }
    }
  });
</script>








    <style>

      .highlight {
        background-color: #ffe5cc;
        border-bottom: 2px solid #ffb266;
      }

      #before-content {
        position: absolute;
        top: 0;
        left: 10 !important;
        right: 0;
        /* Ensure the right side is aligned with the container edge */
        width: 100%;
        padding: 10px !important;

        /* Remove padding to avoid affecting the width */
        box-sizing: border-box;
        /* Ensure content, padding, and borders are within width */
        z-index: 1;
        border-bottom: 1px solid #008938;
        padding-left: 10px;
        /* Add padding-left specifically for content */
      }

      #second-container {
        padding: 0;
        /* Ensure no padding on the container itself */
        box-sizing: border-box;
        /* Ensure container handles padding/border correctly */
      }

      #second-container > * {
        padding-left: 0px;
        z-index: 2;
        /* Ensure content is above the #before-content */
      }
    </style>

    {% endblock %}
  </div>
</div>
